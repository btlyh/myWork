package com.cambrian.dfhm.friend.dao;

import com.cambrian.common.field.ByteArrayField;
import com.cambrian.common.field.Field;
import com.cambrian.common.field.FieldKit;
import com.cambrian.common.field.Fields;
import com.cambrian.common.field.IntField;
import com.cambrian.common.net.ByteBuffer;
import com.cambrian.common.sql.ConnectionManager;
import com.cambrian.common.sql.DBKit;
import com.cambrian.dfhm.friend.entity.FriendInfo;

/**
 * 类说明：好友数据访问类
 * 
 * @author：LazyBear
 */
public class FriendDao
{

	/* static fields */

	/* static methods */

	/* fields */
	/** 连接管理器 */
	ConnectionManager cm;

	/* constructors */

	/* properties */
	public void setConnectionManager(ConnectionManager cm)
	{
		this.cm=cm;
	}
	/* init start */

	/* methods */

	/**
	 * 根据玩家昵称查询userid
	 * 
	 * @param name 玩家昵称
	 * @return
	 */
	public int getUserIdByName(String name)
	{
		int userId = 0;
		Field[] array=new Field[1];
		array[0]=FieldKit.create("userId",0);
		Fields fields=new Fields(array);
		int i = DBKit.get("player",cm,FieldKit.create("nickname",name),fields);
		if(i == DBKit.OK){
			userId = ((IntField)array[0]).value;
		}
		return userId;
	}
	/**
	 * 获取好友信息
	 * 
	 * @param userId 玩家UID
	 * @return
	 */
	public FriendInfo getFriendInfo(int userId)
	{
		Field[] array=new Field[1];
		array[0]=FieldKit.create("friendInfo",(byte[])null);
		Fields fields=new Fields(array);
		DBKit.get("player_info",cm,FieldKit.create("userId",userId),fields);
		byte[] bytes=((ByteArrayField)array[0]).value;
		FriendInfo friendInfo = new FriendInfo();
		friendInfo.dbBytesRead(new ByteBuffer(bytes));
		return friendInfo;
	}
	/**
	 * 是否是好友
	 * 
	 * @param name 玩家昵称
	 * @return
	 */
	public boolean isFriend(String name)
	{
		return false;
	}

	/**
	 * 是否已经申请
	 * 
	 * @param name
	 * @return
	 */
	public boolean isApply(String name)
	{
		return false;
	}
}
